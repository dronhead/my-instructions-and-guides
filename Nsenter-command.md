# üß© Linux namespace –∏ –∫–æ–º–∞–Ω–¥–∞ nsenter

## üîç –ß—Ç–æ —Ç–∞–∫–æ–µ namespace?

Namespace –≤ Linux ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –∏–∑–æ–ª—è—Ü–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ —è–¥—Ä–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

### üìö –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã namespace:

| –¢–∏–ø      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  |
| -------- | ------------------------------------------- |
| `mnt`    | –ò–∑–æ–ª—è—Ü–∏—è —Ç–æ—á–µ–∫ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º |
| `pid`    | –ò–∑–æ–ª—è—Ü–∏—è –¥–µ—Ä–µ–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤                   |
| `net`    | –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤                |
| `ipc`    | –ò–∑–æ–ª—è—Ü–∏—è IPC (–æ—á–µ—Ä–µ–¥–µ–π, —Å–µ–º–∞—Ñ–æ—Ä–æ–≤ –∏ —Ç.–ø.)   |
| `uts`    | –ò–∑–æ–ª—è—Ü–∏—è –∏–º–µ–Ω–∏ —Ö–æ—Å—Ç–∞ –∏ –¥–æ–º–µ–Ω–∞               |
| `user`   | –ò–∑–æ–ª—è—Ü–∏—è UID –∏ GID                          |
| `cgroup` | –ö–æ–Ω—Ç—Ä–æ–ª—å –∏ –∏–∑–æ–ª—è—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (CPU, RAM)     |

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç namespace –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

## üõ† –ß—Ç–æ —Ç–∞–∫–æ–µ `nsenter`?

`nsenter` ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤—Ö–æ–¥–∞ –≤ namespace —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ –µ–≥–æ PID.

–ü–æ–ª–µ–∑–µ–Ω –¥–ª—è:

* –æ—Ç–ª–∞–¥–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
* –≤—Ö–æ–¥–∞ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –±–µ–∑ `docker exec`
* –∞–Ω–∞–ª–∏–∑–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

---

## üö™ –ö–∞–∫ –∑–∞–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ PID?

### 1. –£–∑–Ω–∞—Ç—å PID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ :

–£–∑–Ω–∞—Ç—å PID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `lsns`, –ø—Ä–∏ —ç—Ç–æ–º –Ω—É–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º **root**.

### 2. –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ `nsenter`:

```bash
nsenter -t $PID -m -u -i -n -p bash
```

–ï—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –Ω–µ—Ç bash:

```bash
nsenter -t $PID -m -u -i -n -p sh
```

### –§–ª–∞–≥–∏:

| –§–ª–∞–≥ | Namespace | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ         |
| ---- | --------- | ------------------ |
| `-m` | mount     | –¢–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |
| `-u` | uts       | Hostname           |
| `-i` | ipc       | –û—á–µ—Ä–µ–¥–∏ –∏ —Å–µ–º–∞—Ñ–æ—Ä—ã |
| `-n` | net       | –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã |
| `-p` | pid       | –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤  |

---

## üìå –ü—Ä–∏–º–µ—Ä –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π:

```bash
nsenter --target 12345 --mount --uts --ipc --net --pid bash
```

---

## üß† –°–≤–æ–¥–∫–∞:

* `namespace` ‚Äî –∏–∑–æ–ª—è—Ü–∏—è —Å—Ä–µ–¥—ã
* `nsenter` ‚Äî –≤—Ö–æ–¥ –≤ namespace –ø–æ PID
* –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∞–¥–º–∏–Ω–∫–µ –∏ –æ—Ç–ª–∞–¥–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –±–µ–∑ `docker exec`

---

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `nsenter` –Ω–µ —Ç–æ–ª—å–∫–æ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏, –Ω–æ –∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ª—é–±—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ —Å–≤–æ–∏—Ö namespace (–Ω–∞–ø—Ä–∏–º–µ—Ä, `systemd-nspawn`, `chroot`, LXC –∏ –¥—Ä.).
